<script is:inline>
  const btns = Array.from(document.querySelectorAll(".ln-collapse-btn"));
  btns.forEach((btn) => {
    const root = btn.parentElement?.parentElement;
    if (!root) return;

    const id = root.getAttribute("data-group-id");
    btn.addEventListener("click", () => {
      const expanded = root.getAttribute("data-collapsed") === "true";
      if (expanded) root.setAttribute("data-collapsed", "false");
      else root.setAttribute("data-collapsed", "true");

      if (id) localStorage.setItem(`nav_group:${id}`, expanded ? "false" : "true");
    });

    const state = localStorage.getItem(`nav_group:${id}`);
    if (!state) return;
    root.setAttribute("data-collapsed", state);
  });
</script>
